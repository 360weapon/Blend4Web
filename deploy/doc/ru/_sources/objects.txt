
.. _objects:

*******
Объекты
*******

Объекты служат целям размещения компонентов различного типа (мешей, камер, ламп и т.д.) в пространстве 3D сцены.

Типы
====

Движком поддерживаются объекты следующих типов:

    - меш (mesh)
    - камера (camera)
    - лампа (lamp)
    - пустой (empty)
    - скелет (armature)
    - источник звука (speaker)
    - кривая (curve)
    - текст (text)


.. _static_dynamic_objects:

Статические и динамические объекты
==================================

Все объекты типа ``MESH`` можно разделить на статические и динамические.

**Статические объекты** - объекты, меши которых могут быть объединены друг с другом, если они имеют одинаковый материал.

**Динамические объекты** - объекты, меши которых не могут быть скомбинированы друг с другом.

Объединение статических объектов - т.н. батчинг (batching) - осуществляется автоматически при загрузке сцены в целях оптимизации количества вызовов отрисовки. Конвертация происходит, даже если на сцене присутствует всего один объект. Центр получившегося в результате конвертации меша находится в начале координат.

Среди объектов другого типа динамическими являются ``CAMERA`` и ``ARMATURE``. Остальные - статические.

Объекты, имеющие анимацию, физику или родителя, являющегося динамическим объектом, рассматриваются как динамические.

Перемещение посредством API возможно только в случае динамических объектов. Чтобы обеспечить движение объекта, не имеющего настроек динамического объекта, в его настройках следует активировать опцию ``Blend4Web > Do not batch``.


Настройка
=========

Для объектов всех типов поддерживаются расположение в пространстве, указатель на блок данных, родительский объект, принадлежность к группе и ряд свойств, специфичных для Blend4Web.

Вкладка Object
--------------

.. image:: src_images/objects/object_setup.png
   :align: center
   :width: 100%

|

*Transform > Location*
    Координаты местоположения.

*Transform > Rotation*
    Углы вращения. При повороте объекта доступны все режимы ``Rotation Mode``, но при создании :ref:`объектной анимации <whole_object_anim>` поддерживаются только ``Quaternion (WXYZ)`` и ``XYZ Euler``.

*Transform > Scale*
    Масштабирование. Все 3 компоненты (x, y, z) должны быть одинаковы. Для физических объектов масштабирование не поддерживается.

*Relations > Parent*
    Указатель на родительский объект.

*Groups*
    Группы объектов, которым принадлежит данный объект.


.. image:: src_images/objects/object_setup_b4w.png
   :align: center

|

*Blend4Web > Do not export*
    Не экспортировать.

*Blend4Web > Apply scale*
    Применить масштабирование объекта при экспорте.

.. _apply_modifiers:

*Blend4Web > Apply modifiers*
    Применить модификаторы объекта при экспорте. При наличии модификатора ``SKIN`` рекомендуется применить его перед экспортом, т.к. он сбрасывает слои вертексных цветов и UV-текстур, что может привести к ошибкам экспорта.

*Blend4Web > Export vertex animation*
    Экспортировать предварительно созданную и сохраненную вертексную анимацию.

*Blend4Web > Export edited normals*
    Экспортировать предварительно отредактированные и сохраненные нормали.

*Blend4Web > Animation > Use default*
    Начать воспроизведение в движке связанной с объектом анимации.

*Blend4Web > Animation > Animation blending*
    Только для арматурных объектов. Разрешить плавный переход от одной скелетной
    анимации к другой.

*Blend4Web > Animation > Behavior*
    Поведение анимации при достижении последнего кадра: ``Finish stop`` -
    остановить, ``Finish reset`` - остановить и сбросить в нулевой кадр,
    ``Cyclic`` - циклически повторять.

*Blend4Web > Do not batch*
    Принудительно сделать объект :ref:`динамическим <static_dynamic_objects>`.

*Blend4Web > Dynamic Geometry*
    Разрешить изменение геометрии объекта через API Blend4Web.

*Blend4Web > Disable frustum culling*
    Отключить оптимизацию отсечением по зоне видимости.

*Blend4Web > Disable fogging*
    Отключить туман для объекта.

*Blend4Web > Do not render*
    Отключить рендеринг объекта (например, вспомогательный объект физики).

*Blend4Web > Shadows: Cast*
    Объект будет отбрасывать тени.

*Blend4Web > Shadows: Cast only*
    Объект будет отбрасывать тени, при этом сам будет оставаться невидимым. Становится доступным после включения ``Blend4Web > Shadows: Cast``.

*Blend4Web > Shadows: Receive*
    Разрешить затенение от прилегающих объектов (получение теней) на объекте.

*Blend4Web > Reflections: Reflexible*
    При включении объект будет отражаться от зеркальных поверхностей.

*Blend4Web > Reflections: Reflexible only*
    При включении объект будет отражаться, при этом сам будет оставаться невидимым. Становится доступным после включения ``Blend4Web > Reflections: Reflexible``.

*Blend4Web > Reflections: Reflective*
    При включении объект будет отражать своей поверхностью другие объекты.

*Blend4Web > Reflections: Reflection plane*
    Текстовое поле для названия пустого объекта, задающего плоскость отражения. Становится доступным после включения ``Blend4Web > Reflections: Reflective``.

*Blend4Web > Caustics*
    На объекте будут видны эффекты от прилегающей к нему воды (каустика).

*Blend4Web > Wind bending*
    Включить процедурную анимацию под действием ветра.

*Blend4Web > Selectable*
    Разрешить выделение объекта с помощью мыши или другого устройства ввода, а
    также его подсвечивание (:ref:`эффект Glow <glow>`).

.. _objects_billboarding_properties:

*Blend4Web > Billboard*
    Использовать объект в качестве билборда (т.е. автоматически ориентировать его относительно камеры).

*Blend4Web > Billboarding geometry*
    Способ ориентирования билборда. ``Spherical`` (по умолчанию) - объект всегда ориентирован к камере одной стороной независимо от угла обзора, ``Cylindrical`` - аналогично ``Spherical``, только вращение ограничено осью Z мирового пространства в Blender. Становится доступным после включения ``Blend4Web > Billboard``.

*Blend4Web > LOD transition ratio*
    Параметр для сглаживания переключения между LOD объектами. Определяет, на
    каком дополнительном расстоянии LOD объекты будут видны до замены
    последующими LOD объектами. Назначается для главного объекта. Измеряется в
    долях от радиуса охватывающей сферы объекта.

*Blend4Web > Self LOD > Distance*
    Расстояние от камеры, на котором объект перестает отображаться.

    .. deprecated:: 14.06
        реализовано в стандартном инструменте Blender ``Levels of Detail``.

*Blend4Web > Additional LOD objects*
    Интерфейс добавления низкополигональных объектов для реализации переключения уровня детализации.

    .. deprecated:: 14.06
        реализовано в стандартном инструменте Blender ``Levels of Detail``.


Вкладка Physics (в режиме Blender Game)
---------------------------------------

.. image:: src_images/objects/object_setup_phys.png
   :align: center
   :width: 100%

|

*Blend4Web > Detect collisions*
    Активировать связанную с объектом физику.

*Blend4Web > Floating*
    Сделать объект плавучим. Подробное описание настроек плавучих объектов можно
    найти в разделе :ref:`физика <physics>`.

*Blend4Web > Vehicle*
    Активировать использование объекта в качестве составной части транспортного
    средства. Подробное описание настроек транспортных средств можно найти в
    разделе :ref:`физика <physics>`.

*Blend4Web > Character*
    Активировать использование объекта в качестве физического каркаса игрового
    персонажа. Подробное описание настроек персонажа можно найти в разделе
    :ref:`физика <physics>`.

