b4w.register("gallery_main",function(I,k){function r(a,b){window.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1};var c=document.getElementById(a);c.addEventListener("mousedown",function(b){z(a,b)},!1);c.addEventListener("mouseover",function(b){A(a,b)},!1);c.addEventListener("mouseout",function(b){B(a,b)},!1);c.addEventListener("mouseup",b,!1)}function A(a,b){if("ontouchstart"in window||0<window.navigator.msMaxTouchPoints)return null;document.getElementById(a);var c=document.getElementById("hover_panel"),
d=document.getElementById("glow");d||(d=document.createElement("div"),d.id="glow",d.style.top=b.target.offsetTop,c.appendChild(d),d=document.getElementById("glow"));d.style.top=b.target.offsetTop-20+"px"}function B(a){document.getElementById(a).className="control_panel_button";v()}function s(a){a=document.getElementById(a);document.getElementById("glow");a.className="control_panel_button"}function z(a,b){if("ontouchstart"in window||0<window.navigator.msMaxTouchPoints)return null;b.preventDefault();
v();if(document.getElementsByClassName(a).length)return null;var c=document.getElementById(a),d=document.createElement("div");d.id="glow_down";d.style.marginTop=b.target.offsetTop-28+"px";m.appendChild(d);c.className="control_panel_button button_down"}function v(){var a=document.getElementById("glow_down"),b=document.getElementById("glow");b&&m.removeChild(b);a&&m.removeChild(a)}function J(){w?q.exit_fullscreen():q.request_fullscreen(document.body,function(){w=!0;g("fullscreen_button",!0)},function(){w=
!1;g("fullscreen_button",!1)})}function K(){var a=q.get_url_params();t=a&&a["default"]?a["default"]:"Logo";n=a&&a.tag?a.tag:"nothing";C=a&&1==a.force_default?a.force_default:null;for(var b=!1,a=0;a<e.length;a++){var c=e[a];-1<c.tags.indexOf(n)&&(b=!0)}b||(n="nothing");b=!1;for(a=0;a<e.length;a++)c=e[a],c.name==t&&-1<c.tags.indexOf(n)&&(b=!0);b||(t="Logo")}function x(a){if(f.get("quality")!=a){switch(a){case f.P_LOW:var b="LOW";break;case f.P_HIGH:b="HIGH";break;case f.P_ULTRA:b="ULTRA"}l.set("quality",
b);setTimeout(function(){window.location.reload()},100)}}function L(a,b){var c=D.keysearch("name",a,e);return c&&-1<c.tags.indexOf(b)?!0:!1}function y(a){var b=D.keysearch("name",a,e).load_file;E.load(M+b,N,O,!1);g(a,!0);l.set("last_scene_id",a);switch(l.get("quality")){case "LOW":g("low_mode_button",!0);break;case "HIGH":g("high_mode_button",!0);break;case "ULTRA":g("ultra_mode_button",!0)}}function P(){var a=document.createEvent("CustomEvent");a.initEvent("resize",!1,!1);window.dispatchEvent(a)}
function Q(a){function b(){h.remove_sensor_manifold(d,"AUTO_ROTATE");h.remove_sensor_manifold(d,"DISABLE_AUTO_ROTATE");g(a,!1)}function c(a,b,c){1==c&&(b=h.get_sensor_value(a,b,0),R.rotate_pivot(a,b*S,0))}var d=T.get_active_camera();if(h.check_sensor_manifold(d,"AUTO_ROTATE"))b();else{var e=h.create_mouse_move_sensor("XY"),f=h.create_mouse_click_sensor(),k=h.create_touch_move_sensor("XY"),l=h.create_touch_zoom_sensor(),m=h.create_elapsed_sensor();h.create_sensor_manifold(d,"AUTO_ROTATE",h.CT_CONTINUOUS,
[m],function(a){return a[0]},c);h.create_sensor_manifold(d,"DISABLE_AUTO_ROTATE",h.CT_SHOT,[e,f,k,l],function(a){return a[0]&&a[1]||a[2]||a[3]},b);g(a,!0)}}function g(a,b){var c=document.getElementById(a),d=document.createElement("div");v();d.id="glow_active";d.style.top=c.offsetTop-20+"px";b?(d.className=a,m.appendChild(d),c.className="control_panel_button"):(c=document.getElementsByClassName(a)[0])&&m.removeChild(c)}function U(a){for(var b="",c=0;c<e.length;c++){var d=e[c].name,f=V+e[c].icon,g=
e[c].tags;-1<g.indexOf(a)&&(b+="<div id='"+d+"' class='control_panel_button' style='background-image: url("+f+");'></div>")}u.innerHTML+=b;for(c=0;c<e.length;c++)b=e[c].name,g=e[c].tags,-1<g.indexOf(a)&&W(b)}function W(a){var b=document.getElementById(a);b.addEventListener("mousedown",function(b){z(a,b)},!0);b.addEventListener("mouseup",function(){s(a);E.cleanup();for(var b=0;b<e.length;b++){var d=e[b].name;-1<e[b].tags.indexOf(n)&&g(d,!1)}g("auto_rotate_button",!1);g("low_mode_button",!1);g("high_mode_button",
!1);g("ultra_mode_button",!1);y(a)},!0);b.addEventListener("mouseover",function(b){A(a,b)},!0);b.addEventListener("mouseout",function(){B(a)},!0)}function N(a){f.get("antialiasing");q.enable_camera_controls(1,1)}function O(a,b){F.innerHTML=a+"% ("+Math.round(10*b/1E3)/10+"s)"}function X(a){var b=a.target.innerWidth;a=a.target.innerHeight;Y.resize(b,a);G.innerHTML=Math.round(b)+"x"+Math.round(a)}var q=k("app"),R=k("camera"),f=k("config"),h=k("controls"),E=k("data"),Y=k("main"),T=k("scenes"),l=k("storage"),
D=k("util"),p="DEBUG"===k("version").type(),Z={canvas_container_id:"main_canvas_container",callback:function(a,b){if(b){u=document.getElementById("control_panel");H=document.getElementById("scroll_panel");m=document.getElementById("hover_panel");F=document.getElementById("status_bar_loading");G=document.getElementById("status_bar_resolution");document.getElementById("status_bar");if(-1!=navigator.userAgent.indexOf("Firefox")||-1!=navigator.userAgent.indexOf("rv:11"))u.style.width="90px",m.style.width=
"90px",H.style.width="90px";K();q.enable_controls(a);window.addEventListener("resize",X,!1);P();U(n);r("fullscreen_button",J);r("auto_rotate_button",function(){s("auto_rotate_button");Q("auto_rotate_button")});r("low_mode_button",function(){s("low_mode_button");x(f.P_LOW)});r("high_mode_button",function(){s("high_mode_button");x(f.P_HIGH)});r("ultra_mode_button",function(){s("ultra_mode_button");x(f.P_ULTRA)});"LOW"==l.get("quality")&&f.set("deferred_rendering",!1);f.set("glow",!1);var c=l.get("last_scene_id");
c&&L(c,n)&&!C?y(c):y(t)}else console.log("b4w init failure")},physics_enabled:!1,alpha:!1,gl_debug:!1,show_hud_debug_info:!1,show_fps:!0,fps_elem_id:"status_bar_fps",console_verbose:p,assets_dds_available:!p,assets_min50_available:!p,all_objs_selectable:!1,error_purge_elements:["control_panel_over","status_bar"]},S=.1,p=p?"../../external/deploy/":"../../",V=p+"apps/gallery/",M=p+"assets/",e=[{icon:"icons/logo.png",name:"Logo",load_file:"dev/logo.json",tags:["all","nothing","car","naturemorte"]},{icon:"icons/milk.png",
name:"Bottle",load_file:"fridge/bottle/bottle.json",tags:["all","naturemorte"]},{icon:"icons/naturmort.png",name:"Naturemorte",load_file:"fridge/naturmort/naturmort.json",tags:["all","naturemorte"]}],u,F,G,m,H,w=!1,t=null,n=null,C=null;I.init=function(){l.init("b4w_gallery_storage");var a=l.get("quality");a&&"CUSTOM"!=a||(a="LOW",l.set("quality",a));switch(a){case "LOW":var b=f.P_LOW;break;case "HIGH":b=f.P_HIGH;break;case "ULTRA":b=f.P_ULTRA}f.set("quality",b);q.init(Z)}});b4w.require("gallery_main").init();
