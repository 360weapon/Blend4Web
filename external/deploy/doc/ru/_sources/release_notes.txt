.. _release_notes:

*******************
Замечания к релизам
*******************

.. index:: замечания к релизам

v14.09
======

Новый функционал
----------------

* *Поддержка типа ABSOLUTE для ноды MATH.*

* *Поддержка специализированной ноды LEVELS_OF_QUALITY.*
    Позволяет управлять сложностью материала в зависимости от профиля качества,
    указанного пользователем при загрузке движка.

* *Поддержка специализированной ноды SMOOTHSTEP.*
    Упрощает создание некоторых эффектов в нодовом материале.

* *Поддержка нодовых групп.*
    `Нодовые группы <http://wiki.blender.org/index.php/Doc:2.6/Manual/Composite_Nodes/Node_Groups>`_ позволяют повторное использования блока нод одного материала в составе другого.

* *Возможность вывода промежуточных результатов рендеринга с целью отладки.*
    Результат рендеринга конкретной стадии теперь можно вывести поверх основного изображения. Настройка осуществляется в модуле ``config.js`` опциями группы ``debug_subs``.

* *Реализация логики управления NLA-анимацией в Blender с помощью визуального редактора.*
    В интерфейс Blender добавлен инструмент NLA Script, который позволяет с
    помощью визуальных блоков реализовывать простые сценарии, например
    осуществить управление текущей анимацией в ответ на действия пользователя.

* *Многочисленные улучшения системы сенсоров.*
    В модуле ``controls`` разрешено регистрировать *множества сенсоров*
    глобально, без привязки к конкретному объекту, для чего в соответствующие
    API необходимо подавать параметр ``null``. Обеспечена более предсказуемая и
    надёжная обработка логики сенсоров, в соответствии с последовательностью
    создания их *множеств*. Обработчики событий, связанных с действиями
    пользователя теперь назначаются с помощью функций вида
    ``register_<inputtype>_events()``. В данные функции теперь можно подавать
    флаг ``prevent_default``, позволяющий заблокировать стандартное поведение
    браузера, происходящее после возникновения соответствующих событий.

* *Поддержка использования физики в веб-плеере.*
    Работает только в версии веб-плеера с раздельной загрузкой JSON-файлов. В
    одиночных HTML файлах физика не поддерживается. 

* *Поддержка смешивания различных скелетных анимаций.*
    В модуле ``animation.js`` добавились API, позволяющие осуществлять плавные
    переходы между скелетными анимациями: get_skel_mix_factor() - для получения
    текущего значения коэффициента смешинвания и set_skel_mix_factor() - для его
    назначения.

* *Поддержка анимации ноды Value в нодовых материалах.*
    Функциональность работает аналогично другим видам анимации. Поддерживается работа в NLA.

* *Поддержка параметров Specular и Diffuse в источниках освещения.*

* *Возможность рендеринга полупрозрачного объекта поверх остальных объектов на сцене.*
    Активируется с помощью опции ``Render above all`` для прозрачных материалов (т.е. не ``Opaque``).

* *Автоматическое применение масштаба к мешу объекта.*
    Реализуется включением опции ``Apply scale`` в настройках объекта.

* *Поддержка профиля высокого качества (включая тени, динамическое отражение и антиалиасинг) для iOS.*


Изменения
---------

* *Улучшение рендеринга теней.*
    Существенно изменена система отрисовки теней, которая теперь основывается на технике ``Stable Cascaded Shadow Maps``. Техника позволяет существенно уменьшить мерцание краев теней при движении камеры. Между каскадами реализовано сглаживание. Также тени последнего каскада плавно исчезают при удалении. Для рендеринга мягких теней реализована техника ``Percentage Closer Shadows``. Переработана и упрощена система пользовательских настроек теней. Теперь можно задавать размеры карт теней, степень размытия, настройки для компенсации ошибок самозатенения. Новые настройки подробно :ref:`документированы <shadows>`.

* *Настройка качества графики в веб-плеере теперь сохраняется для каждой сцены независимо.*

* *Изменено поведение настроек конфигурации приложения: physics_uranium_path, smaa_search_texture_path и smaa_area_texture_path.*
    Данные настройки конфигурации теперь рассчитываются автоматически в зависимости от местоположения запускаемого HTML-файла, если они не были переопределены при инициализации приложения.

* *Завершён переход на систему модулей, подключаемых через вызов b4w.require().*
    Это также означает, что начиная с текущей версии в релиз-версии движка
    модули нельзя вызывать с помощью устаревшего интерфейса ``b4w.<module>``.
    С целью совместимости создан аддон ``ns_compat.js``, подключение которого
    позволяет восстановить старое поведение.

* *Добавлена возможность сокрытия панели управления в веб-плеере.*

* *Скелетная анимация применяется только к объекту арматуры.*
    Нет необходимости применять скелетную анимацию к объектам типа ``MESH``.
    Eсли они привязаны к какой-либо анимированной арматуре, скиннинг будет происходить автоматически.

* *Демонстрационные приложения и обучающие материалы приведены в соответствие с новым функционалом.*

Исправления
-----------

* *Индикатор загрузки не скрывался, если в процессе происходила ошибка загрузки ресурса (текстуры либо звукового файла).*

* *Исправлены лаги при масштабировании и повороте на touch-устройствах.*

* *Устранено дрожание камеры типа TARGET при небольших поворотах.*

* *Исправлено управление камерой типа EYE на мобильных устройствах.*

* *Улучшено управление в приложении Ферма в браузере Safari.*

* *Исправлены ошибки при использовании неподдерживаемых моделей освещения на нодовых материалах.*

* *Для объектов без материалов теперь работает опция "Selectable".*

* *Более нет необходимости включать "Do not batch" для объектов, анимирующихся с использованием NLA.*

* *Исправлена ошибка для систем частиц, в которых дуплицируемый объект входит в иерархию с другими объектами.*

Известные проблемы
------------------

* *Проблемы с обновлением аддона в Blender*
    Настоятельно не рекомендуется устанавливать новую версию аддона Blender, не удалив предварительно старую версию, особенно это касается систем Windows.

