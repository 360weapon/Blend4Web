.. _setup:

******************************
Развёртывание среды разработки
******************************

Для работы необходим дистрибутив движка, браузер (настроенный для локального
просмотра) и Blender (с установленным аддоном).

.. _getting_started_distribution:

Установка дистрибутива
======================

Стабильные версии дистрибутива поставляются в виде архива ``blend4web_pro.zip``.
Для установки достаточно распаковать данный архив в любое место на диске.

Для установки дистрибутива участнику группы разработки необходимо клонировать
репозиторий (хранилище) командой:

.. code-block:: none

    > git clone gfxteam@192.168.89.108:blend4web.git b4w

В дистрибутиве находятся исходный код движка, компактная версия для приложений,
скрипты к Blender'у, исходные blend-файлы группы разработки, экспортированные
сцены, текстуры и звуковые файлы (см. подробную :ref:`структуру репозитория
<repo_file_structure>`).

.. index:: браузер; настройка

.. _getting_started_browser:

Настройка браузера
==================

Для работы движка требуется браузер с поддержкой WebGL (например, Chrome или
Firefox). Для проверки можно перейти на страницу http://get.webgl.org/. Должна
появиться надпись зеленого цвета и вращающийся куб:

.. image:: src_images/browser_supports_webgl.jpg
   :alt: Страница тестового сайта при успешной инициализации WebGL
   :align: center
   :width: 100%

.. index:: Blend4Web; установка

Браузер должен быть настроен для загрузки ресурсов из локальной файловой системы. Для этого нужно указать в запускном ярлыке Chrome опцию ``--allow-file-access-from-files`` (подробнее :ref:`о настройке <browser_for_local_loading>`).


.. index:: просмотрщик; запуск

.. _getting_started_launching_viewer:

Запуск просмотрщика сцен
========================

Откройте файл :file:`apps_dev/viewer/viewer_dev.html` в настроенном браузере. Должна отобразиться страница с окном рендерера и элементами интерфейса.

.. image:: src_images/engine_screens/default_page.jpg
   :alt: Первый запуск рендерера
   :align: center
   :width: 100%

|

.. note::

    Если страница не отображается корректно, или появляются сообщения об ошибках, необходимо предпринять действия, описанные в разделе :ref:`renderer_not_working`.


.. index:: Blender; установка

.. _getting_started_addon:

Установка аддона движка
=======================

Запустить Blender, загрузить сцену по умолчанию :file:`File > New` (горячие клавиши :file:`Ctrl-N`).
Вызвать окно пользовательских настроек :file:`File > User Preferences...` (горячие клавиши :file:`Ctrl-Alt-U`). Во вкладке  :file:`File` в поле  :file:`Scripts` выбрать путь к директории :file:`blender_scripts`. 

.. image:: src_images/blender_screens/user_preferences_scripts_path.jpg
   :alt: Указание пути для скриптов в окне пользовательских настроек
   :align: center
   :width: 100%

Нажать :file:`Save User Settings` и перезапустить Blender.

*Примечание:*

Вместо этого можно скопировать директорию со скриптами :file:`blender_scripts/addons/blend4web` в уже используемую пользовательскую директорию для скриптов или даже в установочную директорию, например:

:file:`C:\\Program Files\\Blender Foundation\\Blender\\2.69\\scripts\\addons\\blend4web`.


Повторно загрузить сцену по умолчанию, вызвать окно пользовательских настроек, перейти на вкладку :file:`Addons` и выбрать категорию :file:`Import-Export`. Отметить галочку напротив :file:`Import-Export: Blend4Web`. 
Также можно указать, где находятся исходные файлы для экспорта сцены в формате html (поле :file:`Path to b4w source`). Стандартный путь для них (относительно корня движка): :file:`external/deploy/apps/embed`.

.. image:: src_images/blender_screens/user_preferences_enable_addon.jpg
   :alt: Инициализация скриптов в окне пользовательских настроек
   :align: center
   :width: 100%

Нажать :file:`Save User Settings`. Перезапуск Blender не требуется.

*Для проверки:*

В меню :file:`File > Export` должны появиться опции :file:`Blend4Web (.json)` и :file:`Blend4Web (.html)`. Кроме того должны появиться операторы при выполнении поиска по "B4W" (горячая клавиша :file:`ПРОБЕЛ`).

