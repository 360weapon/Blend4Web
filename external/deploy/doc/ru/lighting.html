<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Освещение, тени и фон &mdash; Руководство пользователя: Blend4Web v14.08</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '14.08',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="Об этих документах" href="about.html" />
    <link rel="top" title="Руководство пользователя: Blend4Web v14.08" href="index.html" />
    <link rel="next" title="Постпроцессинговые эффекты" href="postprocessing_effects.html" />
    <link rel="prev" title="Нодовые материалы" href="node_materials.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="index.html">
            <img class="logo" src="_static/b4w_logo.png" alt="Logo"/>
          </a></p>
        <div class="headertitle"><a
          href="index.html">Руководство пользователя: Blend4Web v14.08</a></div>
        <div class="rel">
          <a href="node_materials.html" title="Нодовые материалы"
             accesskey="P">предыдущий</a> |
          <a href="postprocessing_effects.html" title="Постпроцессинговые эффекты"
             accesskey="N">следующий</a> |
          <a href="genindex.html" title="Алфавитный указатель"
             accesskey="I">указатель</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="lighting"></span><div class="section" id="index-0">
<span id="id1"></span><h1>Освещение, тени и фон<a class="headerlink" href="#index-0" title="Ссылка на этот заголовок">¶</a></h1>
<div class="section" id="index-1">
<span id="id2"></span><h2>Освещение от источников света<a class="headerlink" href="#index-1" title="Ссылка на этот заголовок">¶</a></h2>
<p>На сцене может быть несколько (но не менее одного) источников света разного типа.</p>
<div class="section" id="id3">
<h3>Типы источников света<a class="headerlink" href="#id3" title="Ссылка на этот заголовок">¶</a></h3>
<p>Поддерживаются источники света следующих типов:</p>
<dl class="docutils">
<dt><em>Point</em></dt>
<dd>Точечный. Свет распространяется из одной точки равномерно во все стороны, с постепенным затуханием.</dd>
<dt><em>Sun</em></dt>
<dd>&#8220;Солнце&#8221;. Свет распространяется из бесконечной плоскости прямолинейно в одном направлении, без затухания.</dd>
<dt><em>Spot</em></dt>
<dd>Прожектор. Свет распространяется из одной точки, с ограничением угла распространения, с постепенным затуханием.</dd>
<dt><em>Hemi</em></dt>
<dd>Полусфера. Свет распространяется из бесконечной полусферы, без затухания.</dd>
</dl>
</div>
<div class="section" id="id4">
<h3>Настройка источников света<a class="headerlink" href="#id4" title="Ссылка на этот заголовок">¶</a></h3>
<p>Производится во вкладке <tt class="docutils literal"><span class="pre">Object</span> <span class="pre">Data</span></tt> при выборе объекта-лампы.</p>
<a class="reference internal image-reference" href="_images/lighting_setup.jpg"><img alt="_images/lighting_setup.jpg" class="align-center" src="_images/lighting_setup.jpg" style="width: 100%;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="docutils">
<dt><em>Color</em></dt>
<dd>Цветовая характеристика света. Значение по умолчанию (1.0, 1.0, 1.0) (белый).</dd>
<dt><em>Energy</em></dt>
<dd>Интенсивность излучения. Значение по умолчанию 1.0.</dd>
<dt><em>Falloff</em></dt>
<dd>Тип затухания. Значение экспортируется, но в движке всегда используется <tt class="docutils literal"><span class="pre">Inverse</span> <span class="pre">Square</span></tt> (обратный квадратичный). Применяется для источников света типа <tt class="docutils literal"><span class="pre">Point</span></tt> и <tt class="docutils literal"><span class="pre">Spot</span></tt>. Значение по умолчанию <tt class="docutils literal"><span class="pre">Inverse</span> <span class="pre">Square</span></tt>.</dd>
<dt><em>Distance</em></dt>
<dd>Параметр затухания. Применяется для источников света типа <tt class="docutils literal"><span class="pre">Point</span></tt> и <tt class="docutils literal"><span class="pre">Spot</span></tt>. Значение по умолчанию 25.0.</dd>
<dt><em>Spot Shape &gt; Size</em></dt>
<dd>Угол конуса в градусах. Применяется для источников света типа <tt class="docutils literal"><span class="pre">Spot</span></tt>. Значение по умолчанию 45º.</dd>
<dt><em>Spot Shape &gt; Blend</em></dt>
<dd>Параметр смягчения края светового пятна. Применяется для источников света типа <tt class="docutils literal"><span class="pre">Spot</span></tt>. Значение по умолчанию 0.15.</dd>
<dt><em>Blend4Web &gt; Do not export</em></dt>
<dd>Не экспортировать. По умолчанию отключено.</dd>
<dt><em>Blend4Web &gt; Generate shadows</em></dt>
<dd>Источник света используется для расчета падающих теней. Применяется в случае наличия нескольких источников света. По умолчанию отключено.</dd>
<dt><em>Blend4Web &gt; Dynamic intesity</em></dt>
<dd>Источник света используется для расчета изменения времени суток. Применяется для источников света типа &#8220;Солнце&#8221;. По умолчанию отключено.</dd>
</dl>
</div>
</div>
<div class="section" id="id5">
<h2>Освещение от окружающей среды<a class="headerlink" href="#id5" title="Ссылка на этот заголовок">¶</a></h2>
<p>Движком используется простая полусферическая модель освещения, в которой задается цвет горизонта и цвет зенита.</p>
<div class="section" id="id6">
<h3>Активация<a class="headerlink" href="#id6" title="Ссылка на этот заголовок">¶</a></h3>
<p>Включить опцию <tt class="docutils literal"><span class="pre">Environment</span> <span class="pre">Lighting</span></tt> во вкладке <tt class="docutils literal"><span class="pre">World</span></tt>.</p>
<a class="reference internal image-reference" href="_images/lighting_environment.jpg"><img alt="_images/lighting_environment.jpg" class="align-center" src="_images/lighting_environment.jpg" style="width: 100%;" /></a>
</div>
<div class="section" id="id7">
<h3>Настройка<a class="headerlink" href="#id7" title="Ссылка на этот заголовок">¶</a></h3>
<dl class="docutils">
<dt><em>Environment Lighting &gt; Energy</em></dt>
<dd>Интенсивность освещения от окружающей среды. Значение по умолчанию 1.0.</dd>
<dt><em>Environment Lighting &gt; Environment Color</em></dt>
<dd>Тип источника освещения, поддерживаются <tt class="docutils literal"><span class="pre">White</span></tt> и <tt class="docutils literal"><span class="pre">Sky</span> <span class="pre">Color</span></tt>. При выборе <tt class="docutils literal"><span class="pre">White</span></tt> назначается белый цвет горизонта и белый цвет зенита. При выборе <tt class="docutils literal"><span class="pre">Sky</span> <span class="pre">Color</span></tt> цвет горизонта и цвет зенита задаются цветоподборщиками <tt class="docutils literal"><span class="pre">World</span> <span class="pre">&gt;</span> <span class="pre">Horizon</span> <span class="pre">Color</span></tt> и <tt class="docutils literal"><span class="pre">World</span> <span class="pre">&gt;</span> <span class="pre">Zenith</span> <span class="pre">Color</span></tt>. Значение по умолчанию <tt class="docutils literal"><span class="pre">White</span></tt>.</dd>
<dt><em>World &gt; Horizon Color</em> и <em>World &gt; Zenith Color</em></dt>
<dd>Цвет горизонта и цвет зенита. При выборе цвета рекомендуется активировать опцию <tt class="docutils literal"><span class="pre">World</span> <span class="pre">&gt;</span> <span class="pre">Blend</span> <span class="pre">Sky</span></tt>.</dd>
</dl>
</div>
</div>
<div class="section" id="id8">
<h2>Тени<a class="headerlink" href="#id8" title="Ссылка на этот заголовок">¶</a></h2>
<div class="section" id="id9">
<h3>Активация<a class="headerlink" href="#id9" title="Ссылка на этот заголовок">¶</a></h3>
<ol class="arabic simple">
<li>На объектах, <strong>отбрасывающих</strong> тени, включить опцию <tt class="docutils literal"><span class="pre">Blend4Web</span> <span class="pre">&gt;</span> <span class="pre">Shadows:</span> <span class="pre">Cast</span></tt> во вкладке <tt class="docutils literal"><span class="pre">Object</span></tt>.</li>
<li>На объектах, <strong>получающих</strong> тени, включить опцию <tt class="docutils literal"><span class="pre">Blend4Web</span> <span class="pre">&gt;</span> <span class="pre">Shadows:</span> <span class="pre">Receive</span></tt> во вкладке <tt class="docutils literal"><span class="pre">Object</span></tt>.</li>
<li>Убедиться, что включена опция <tt class="docutils literal"><span class="pre">Blend4Web</span> <span class="pre">&gt;</span> <span class="pre">Render</span> <span class="pre">shadows</span></tt> во вкладке <tt class="docutils literal"><span class="pre">Scene</span></tt>.</li>
</ol>
</div>
<div class="section" id="id10">
<h3>Настройка<a class="headerlink" href="#id10" title="Ссылка на этот заголовок">¶</a></h3>
<dl class="docutils">
<dt><em>Направление</em></dt>
<dd>В случае наличия нескольких источников света рекомендуется указать, какой именно источник света будет использоваться для расчета падающих теней, включив опцию <tt class="docutils literal"><span class="pre">Blend4Web</span> <span class="pre">&gt;</span> <span class="pre">Generate</span> <span class="pre">shadows</span></tt> во вкладке <tt class="docutils literal"><span class="pre">Object</span> <span class="pre">Data</span></tt> при выборе объекта-лампы.</dd>
<dt><em>Цвет</em></dt>
<dd>Цвет тени определяется настройками освещения от окружающей среды.</dd>
</dl>
<p>Во вкладке <tt class="docutils literal"><span class="pre">World</span></tt> на панели <tt class="docutils literal"><span class="pre">Blend4Web</span> <span class="pre">&gt;</span> <span class="pre">Shadow</span> <span class="pre">Settings</span></tt> находятся дополнительные настройки:</p>
<div class="section" id="id11">
<h4>Каскады<a class="headerlink" href="#id11" title="Ссылка на этот заголовок">¶</a></h4>
<p>Для обеспечения приемлемого качества теней и одновременно покрытия значительных пространств необходимо использовать несколько стадий генерации теней (каскадов). При этом вблизи наблюдателя располагается каскад с наилучшим качеством, вдали от наблюдателя — с наихудшим.</p>
<a class="reference internal image-reference" href="_images/shadow_cascades.jpg"><img alt="_images/shadow_cascades.jpg" class="align-center" src="_images/shadow_cascades.jpg" style="width: 100%;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="docutils">
<dt><em>CSM number</em></dt>
<dd>Количество каскадов теней. Поддерживается от 1 до 4 каскадов. Значение по умолчанию 3.</dd>
<dt><em>CSM near</em></dt>
<dd>Ближняя граница отображения теней. Значение по умолчанию 0.1.</dd>
<dt><em>CSM far</em></dt>
<dd>Дальняя граница отображения теней. Значение по умолчанию 100.0.</dd>
<dt><em>CSM lambda</em></dt>
<dd>Фактор распределения границ между каскадами. Рассчитанные значения границ каскадов отображаются в просмотрщике во вкладке <tt class="docutils literal"><span class="pre">Shadows</span></tt>. Значение по умолчанию 0.875.</dd>
</dl>
</div>
<div class="section" id="id12">
<h4>Мягкие тени<a class="headerlink" href="#id12" title="Ссылка на этот заголовок">¶</a></h4>
<dl class="docutils">
<dt><em>Visibility falloff</em></dt>
<dd>Фактор экспонециального уменьшения видимости тени в зависимости от расстояния от точки отбрасывания до точки получения. Применяется для уменьшения видимости артефактов собственных теней (т.е. отбрасывания объектом тени на себя). Значение по умолчанию 3500.0.</dd>
<dt><em>Blur depth size mult</em></dt>
<dd>Размер ядра сглаживания. Влияет на степень смягчения теней. Значение по умолчанию 1.0.</dd>
<dt><em>Blur depth edge size</em></dt>
<dd>Разница между сэмплами (в текселях) при определении границ. Уменьшает ореол, исключая сглаживание границ. Значение по умолчанию 2.0.</dd>
<dt><em>Blur depth diff threshold</em></dt>
<dd>Максимум разницы глубины при определении границ, умноженный на 1000. Уменьшает ореол, исключая сглаживание границ. Значение по умолчанию 0.1.</dd>
</dl>
</div>
</div>
</div>
<div class="section" id="index-2">
<span id="id13"></span><h2>Цвет фона<a class="headerlink" href="#index-2" title="Ссылка на этот заголовок">¶</a></h2>
<p>Цвет фона можно задать несколькими способами:</p>
<ol class="arabic">
<li><p class="first">Поместить сцену внутрь модели (например, куба или сферы) с направленными внутрь нормалями, с материалом и опциональной текстурой.</p>
</li>
<li><p class="first">Использовать <a class="reference internal" href="textures.html#skydome-texture"><em>кубическую текстуру</em></a>.</p>
</li>
<li><p class="first">Настроить динамически генерируемую <a class="reference internal" href="outdoor_rendering.html#atmosphere"><em>атмосферу</em></a>.</p>
</li>
<li><p class="first">Установить параметр движка <tt class="docutils literal"><span class="pre">background_color</span></tt>, используя программный метод <tt class="docutils literal"><span class="pre">config.set()</span></tt>. Установленное значение используется в качестве аргумента метода WebGL <tt class="docutils literal"><span class="pre">clearColor()</span></tt>. Для получения корректных результатов рекомендуется отключить прозрачность контекста WebGL (параметр <tt class="docutils literal"><span class="pre">alpha</span></tt>). Такая конфигурация используется по умолчанию в стандартном веб-плеере движка.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">m_cfg</span> <span class="o">=</span> <span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">m_main</span> <span class="o">=</span> <span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">);</span>

<span class="nx">m_cfg</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;background_color&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Float32Array</span><span class="p">([</span><span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]));</span> <span class="c1">// gray</span>
<span class="nx">m_cfg</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>

<span class="nx">m_main</span><span class="p">.</span><span class="nx">init</span><span class="p">(...);</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">В качестве фона можно использовать любой HTML контент, находящийся позади элемента <tt class="docutils literal"><span class="pre">canvas</span></tt>, который используется для рендеринга. Для это необходимо активировать прозрачность контекста WebGL (параметр <tt class="docutils literal"><span class="pre">alpha</span></tt>). Для получения корректных результатов рекомендуется выставить полностью прозрачный черный цвет фона. Такая конфигурация используется по умолчанию в стандартном <a class="reference internal" href="viewer.html#viewer"><em>просмотрщике сцен</em></a> SDK движка.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">m_cfg</span> <span class="o">=</span> <span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">m_main</span> <span class="o">=</span> <span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">);</span>

<span class="nx">m_cfg</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;background_color&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Float32Array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]));</span>
<span class="nx">m_cfg</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="nx">m_main</span><span class="p">.</span><span class="nx">init</span><span class="p">(...);</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">См.также</p>
<p class="last"><a class="reference internal" href="gamma_alpha.html#alpha-compositing"><em>Альфа-композитинг</em></a></p>
</div>
</div></blockquote>
</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Оглавление</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">Общие сведения</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Функционал движка</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_steps.html">Экспресс-установка</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Развёртывание среды разработки</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Рабочий процесс</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewer.html">Просмотрщик сцен</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_player.html">Веб-плеер</a></li>
<li class="toctree-l1"><a class="reference internal" href="addon.html">Аддон</a></li>
<li class="toctree-l1"><a class="reference internal" href="objects.html">Объекты</a></li>
<li class="toctree-l1"><a class="reference internal" href="textures.html">Текстуры</a></li>
<li class="toctree-l1"><a class="reference internal" href="materials.html">Материалы</a></li>
<li class="toctree-l1"><a class="reference internal" href="node_materials.html">Нодовые материалы</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Освещение, тени и фон</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#index-1">Освещение от источников света</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">Освещение от окружающей среды</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id8">Тени</a></li>
<li class="toctree-l2"><a class="reference internal" href="#index-2">Цвет фона</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="postprocessing_effects.html">Постпроцессинговые эффекты</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles.html">Система частиц</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles_instancing.html">Система частиц для инстансинга объектов</a></li>
<li class="toctree-l1"><a class="reference internal" href="animation.html">Анимация</a></li>
<li class="toctree-l1"><a class="reference internal" href="outdoor_rendering.html">Рендеринг наружных сцен</a></li>
<li class="toctree-l1"><a class="reference internal" href="gamma_alpha.html">Гамма-коррекция и альфа-композитинг</a></li>
<li class="toctree-l1"><a class="reference internal" href="audio.html">Звуковая подсистема</a></li>
<li class="toctree-l1"><a class="reference internal" href="physics.html">Физика</a></li>
<li class="toctree-l1"><a class="reference internal" href="nla.html">Нелинейная анимация</a></li>
<li class="toctree-l1"><a class="reference internal" href="developers.html">Разработчикам приложений</a></li>
<li class="toctree-l1"><a class="reference internal" href="developers_advanced.html">Разработчикам движка</a></li>
<li class="toctree-l1"><a class="reference internal" href="git_short_manual.html">Работа в команде. Использование git</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems_and_solutions.html">Проблемы и решения</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Поиск</h3>
          <form class="search" action="search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Искать" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Введите слова для поиска или имя модуля, класса или функции.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="node_materials.html" title="Нодовые материалы"
             >предыдущий</a> |
          <a href="postprocessing_effects.html" title="Постпроцессинговые эффекты"
             >следующий</a> |
          <a href="genindex.html" title="Алфавитный указатель"
             >указатель</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2014, ООО &#34;Триумф&#34;.
      Обновлено: 2014-08-25.
      Создано с помощью <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>